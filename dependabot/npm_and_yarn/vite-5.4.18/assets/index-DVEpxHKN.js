function w(e){return e.charAt(0).toLowerCase()+e.slice(1)}function y(e,t,n){if(!e.shiftKey){const i=e.key;switch(i){case"Enter":case"Escape":case"PageUp":case"PageDown":case"End":case"Home":case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":t.dispatchEvent(new CustomEvent(w(`${i}Key${n}`),{detail:e,bubbles:!0}));break;case" ":t.dispatchEvent(new CustomEvent(`spacebarKey${n}`,{detail:e,bubbles:!0}));break;default:return}}}function m(e){y(e,this,"Down")}function _(e){e.addEventListener("keydown",m)}function I(e){e.removeEventListener("keydown",m)}const l={},k="nid",D=p(3);function f(e){return Math.floor(Math.random()*e)}function p(e){const t="abcdefghijklmnopqrstuvwxyz",i=t+"0123456789";let s=t[f(25)];for(let r=1;r<e;r++)s+=i[f(35)];return s}function F(e,t=k){const i=`${t}${t===""?"":"-"}${D}`;return l[i]=l[i]||0,e.id||e.setAttribute("id",`${i}-${l[i]++}`),e.id}const c={};function E(e,t,n){e.dispatchEvent(new CustomEvent("focusExit",{detail:{fromElement:t,toElement:n},bubbles:!1}))}function K(e){const t=e.target;this.el.contains(t)===!0?this.currentFocusElement=t:(window.removeEventListener("blur",this.onWindowBlurListener),document.removeEventListener("focusin",this.onDocumentFocusInListener),E(this.el,this.currentFocusElement,t),this.currentFocusElement=null)}function N(){E(this.el,this.currentFocusElement,void 0)}function B(){document.addEventListener("focusin",this.onDocumentFocusInListener),window.addEventListener("blur",this.onWindowBlurListener)}class A{constructor(t){this.el=t,this.currentFocusElement=null,this.onWidgetFocusInListener=B.bind(this),this.onDocumentFocusInListener=K.bind(this),this.onWindowBlurListener=N.bind(this),this.el.addEventListener("focusin",this.onWidgetFocusInListener)}removeEventListeners(){window.removeEventListener("blur",this.onWindowBlurListener),document.removeEventListener("focusin",this.onDocumentFocusInListener),this.el.removeEventListener("focusin",this.onWidgetFocusInListener)}}function C(e){let t=null;return F(e),c[e.id]||(t=new A(e),c[e.id]=t),t}function P(e){const t=c[e.id];t&&(t.removeEventListeners(),delete c[e.id])}const M={axis:"both",autoInit:"interactive",autoReset:"current",ignoreByDelegateSelector:null,wrap:!1};function a(e){return!e.hidden&&e.getAttribute("aria-disabled")!=="true"}function x(e,t){return t>=0&&t<e.length?a(e[t]):!1}function S(e){return e.filter(a)}function o(e){return e.findIndex(t=>a(t))}function u(e){return e.indexOf(S(e).reverse()[0])}function g(e,t,n){return e.findIndex(i=>a(i)&&i.getAttribute(t)===n)}function W(e){return g(e,"aria-checked","true")}function v(e){return g(e,"aria-selected","true")}function d(e,t){return t.ignoreByDelegateSelector!==null?[...e.querySelectorAll(t.ignoreByDelegateSelector)]:[]}function $(e,t,n){let i=-1;if(t===null||R(e,t))n===!0&&(i=u(e));else{let s=t;for(;--s>=0;)if(a(e[s])){i=s;break}}return i}function O(e,t,n){let i=-1;if(t===null)i=o(e);else if(H(e,t))n===!0&&(i=o(e));else{let s=t;for(;++s<e.length;)if(a(e[s])){i=s;break}}return i}function b(e,t,n){let i=-1;switch(e){case"none":i=null;break;case"current":i=n;break;case"interactive":i=o(t);break;case"ariaChecked":i=W(t);break;case"ariaSelected":i=v(t);break;case"ariaSelectedOrInteractive":i=v(t),i=i===-1?o(t):i;break;default:i=typeof e=="number"||e===null?e:-1}return i}function R(e,t){return t===o(e)}function H(e,t){return t===u(e)}function U(e){const t=d(this._el,this.options);(t.length===0||!t.includes(e.detail.target))&&(this.index=$(this.items,this.index,this.options.wrap))}function q(e){const t=d(this._el,this.options);(t.length===0||!t.includes(e.detail.target))&&(this.index=O(this.items,this.index,this.options.wrap))}function j(e){const t=this.indexOf(e.target.closest(this._itemSelector));x(this.items,t)&&(this.index=t)}function z(e){const t=d(this._el,this.options);(t.length===0||!t.includes(e.detail.target))&&(this.index=o(this.items))}function V(e){const t=d(this._el,this.options);(t.length===0||!t.includes(e.detail.target))&&(this.index=u(this.items))}function G(){this.options.autoReset!==null&&this.reset()}function J(e){const t=this.index;let n=this.index;const{addedNodes:i,attributeName:s,removedNodes:r,target:L,type:h}=e[0];h==="attributes"?L===this.currentItem?s==="aria-disabled"?n=this.index:s==="hidden"&&(n=o(this.items)):n=this.index:h==="childList"&&(r.length>0&&[...r].includes(this._cachedElement)?n=o(this.items):(r.length>0||i.length>0)&&(n=this.indexOf(this._cachedElement))),this._index=n,this._el.dispatchEvent(new CustomEvent("navigationModelMutation",{bubbles:!1,detail:{fromIndex:t,toIndex:n}}))}class Q{constructor(t,n,i){this.options=Object.assign({},M,i),this._el=t,this._itemSelector=n}}class T extends Q{constructor(t,n,i){super(t,n,i);const s=this._index,r=b(this.options.autoInit,this.items,this.index);this._index=r,this._cachedElement=this.items[r],this._el.dispatchEvent(new CustomEvent("navigationModelInit",{bubbles:!1,detail:{firstInteractiveIndex:this.firstNavigableIndex,fromIndex:s,items:this.items,toIndex:r}}))}get currentItem(){return this.items[this.index]}get items(){return[...this._el.querySelectorAll(`${this._itemSelector}`)]}get index(){return this._index}set index(t){if(t!==this.index&&x(this.items,t)){const n=this.index;this._cachedElement=this.items[t],this._index=t,this._el.dispatchEvent(new CustomEvent("navigationModelChange",{bubbles:!1,detail:{fromIndex:n,toIndex:t}}))}}indexOf(t){return this.items.indexOf(t)}reset(){const t=this.index,n=b(this.options.autoReset,this.items,this.index);n!==t&&(this._index=n,this._el.dispatchEvent(new CustomEvent("navigationModelReset",{bubbles:!1,detail:{fromIndex:t,toIndex:n}})))}}class X{constructor(t,n){this.model=n,this.el=t,this._keyPrevListener=U.bind(n),this._keyNextListener=q.bind(n),this._keyHomeListener=z.bind(n),this._keyEndListener=V.bind(n),this._clickListener=j.bind(n),this._focusExitListener=G.bind(n),this._observer=new MutationObserver(J.bind(n)),_(this.el),C(this.el);const i=n.options.axis;(i==="both"||i==="x")&&(this.el.addEventListener("arrowLeftKeyDown",this._keyPrevListener),this.el.addEventListener("arrowRightKeyDown",this._keyNextListener)),(i==="both"||i==="y")&&(this.el.addEventListener("arrowUpKeyDown",this._keyPrevListener),this.el.addEventListener("arrowDownKeyDown",this._keyNextListener)),this.el.addEventListener("homeKeyDown",this._keyHomeListener),this.el.addEventListener("endKeyDown",this._keyEndListener),this.el.addEventListener("click",this._clickListener),this.el.addEventListener("focusExit",this._focusExitListener),this._observer.observe(this.el,{childList:!0,subtree:!0,attributeFilter:["aria-disabled","hidden"],attributes:!0,attributeOldValue:!0})}destroy(){I(this.el),P(this.el),this.el.removeEventListener("arrowLeftKeyDown",this._keyPrevListener),this.el.removeEventListener("arrowRightKeyDown",this._keyNextListener),this.el.removeEventListener("arrowUpKeyDown",this._keyPrevListener),this.el.removeEventListener("arrowDownKeyDown",this._keyNextListener),this.el.removeEventListener("homeKeyDown",this._keyHomeListener),this.el.removeEventListener("endKeyDown",this._keyEndListener),this.el.removeEventListener("click",this._clickListener),this.el.removeEventListener("focusExit",this._focusExitListener),this._observer.disconnect()}}function Y(e,t,n){const i=new T(e,t,n);return new X(e,i)}export{Y as c};
